dist: trusty
sudo: required

language: python

services: docker

before_install:
  - docker run -d --name ubuntu -v $(pwd):/travis ubuntu:latest tail -f /dev/null
  - docker ps

install:
  - docker exec -t ubuntu bash -c "apt-get update;
    apt-get install -y python3 python3-gi dbus-x11;
    apt-get install -y python3-pip;
    /usr/bin/python3 -V;
    /urs/bin/easy_install pip;
    /usr/bin/pip3 install -r requirements.txt;
    /usr/bin/pip3 install -r requirements-test.txt;
    /usr/bin/dbus-launch --sh-syntax > dummy;
    . dummy;
    rm dummy;"

script:
  - docker exec -t ubuntu bash -c "cd /travis;
    ls -al;
    /usr/bin/python3 -V;
    flake8;
    nosetests --nologcapture;"

notifications:
  email: false
